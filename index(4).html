
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario BanCoppel</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    label { font-weight: bold; display: block; margin-top: 10px; }
    input, select, textarea, button { width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 10px; }
    textarea { height: 60px; }
  </style>
</head>
<body>
  <h2>Formulario BanCoppel</h2>

  <label for="usuario">Usuario (Ingresa tu nombre completo):</label>
  <input type="text" id="usuario" placeholder="Ingresa tu nombre completo" required />

  <label for="nombre">Nombre:</label>
  <input type="text" id="nombre" disabled />

  <label for="celular">Teléfono:</label>
  <input type="text" id="celular" disabled />

  <label for="producto">N. Cliente Bancoppel:</label>
  <input type="text" id="producto" disabled />

  <label for="telfijo">Teléfono Fijo:</label>
  <input type="text" id="telfijo" disabled />

  <label for="edad">Edad:</label>
  <input type="text" id="edad" disabled />

  <label for="antiguedad">Antigüedad del Banco:</label>
  <input type="text" id="antiguedad" disabled />

  <label for="zona">Zona:</label>
  <input type="text" id="zona" disabled />

  <label for="tipificacion">Tipificación:</label>
  <select id="tipificacion"></select>

  <label for="correo">Correo Electrónico:</label>
  <input type="email" id="correo" disabled />

  <label for="comentarios">Comentarios:</label>
  <textarea id="comentarios"> </textarea>

  <label for="fecha">Fecha y Hora:</label>
  <input type="text" id="fecha" disabled />

  <button onclick="generarRegistro()">Generar registro</button>
  <button onclick="guardarRegistro()">Guardar registro</button>
  <button onclick="buscarRegistro()">Buscar registro</button>

  <script>
    const url = 'https://script.google.com/macros/s/AKfycby5vwvZKULUs2ULIiGqn0higkzKfagQkHrfhASKCKjCqN28KVljQh0M45_dwZDROPsKCg/exec';

    const tipificaciones = [
      "VENTA EXITOSA", "ACUDIRA A SUCURSAL", "CLIENTE COLGO", "CLIENTE MOLESTO", "COLABORADOR",
      "DESCONFIANZA", "EQUIVOCADO", "LLAMAR DESPUES", "NO CUBRE PERFIL", "NO CUENTA CON APP",
      "NO DA INFORMACION", "NO ES CLIENTE BANCOPPEL", "NO INTERESA", "NO SE ENCUENTRA",
      "PENDIENTE", "TERCERA PERSONA", "BUZON", "FUERA DE SERVICIO", "NO CONTESTA", "OCUPADO", "SUSPENDIDO"
    ];

    const tipificacionSelect = document.getElementById("tipificacion");
    tipificaciones.forEach(t => {
      const option = document.createElement("option");
      option.value = t;
      option.text = t;
      tipificacionSelect.appendChild(option);
    });

    function generarRegistro() {
      fetch(url + '?accion=generar')
        .then(res => res.json())
        .then(data => {
          document.getElementById("nombre").value = data.nombre;
          document.getElementById("celular").value = data.celular;
          document.getElementById("producto").value = data.producto;
          document.getElementById("telfijo").value = data.telfijo;
          document.getElementById("edad").value = data.edad;
          document.getElementById("antiguedad").value = data.antiguedad;
          document.getElementById("zona").value = data.zona;
          document.getElementById("correo").value = data.correo;
        });
    }

    function guardarRegistro() {
      const registro = {
        usuario: document.getElementById("usuario").value,
        nombre: document.getElementById("nombre").value,
        celular: document.getElementById("celular").value,
        producto: document.getElementById("producto").value,
        telfijo: document.getElementById("telfijo").value,
        edad: document.getElementById("edad").value,
        antiguedad: document.getElementById("antiguedad").value,
        zona: document.getElementById("zona").value,
        tipificacion: document.getElementById("tipificacion").value,
        correo: document.getElementById("correo").value,
        comentarios: document.getElementById("comentarios").value,
        fecha: new Date().toLocaleString("es-MX")
      };

      fetch(url, {
        method: 'POST',
        body: JSON.stringify(registro),
        headers: { 'Content-Type': 'application/json' }
      }).then(r => alert("Registro guardado"));
    }

    function buscarRegistro() {
      const celular = prompt("Ingresa el número celular a buscar:");
      if (!celular) return;
      fetch(url + '?accion=buscar&celular=' + celular)
        .then(res => res.json())
        .then(data => {
          document.getElementById("nombre").value = data.nombre;
          document.getElementById("celular").value = data.celular;
          document.getElementById("producto").value = data.producto;
          document.getElementById("telfijo").value = data.telfijo;
          document.getElementById("edad").value = data.edad;
          document.getElementById("antiguedad").value = data.antiguedad;
          document.getElementById("zona").value = data.zona;
          document.getElementById("correo").value = data.correo;
          document.getElementById("comentarios").value = data.comentarios;
          document.getElementById("tipificacion").value = data.tipificacion;
          document.getElementById("usuario").value = data.usuario;
          document.getElementById("fecha").value = data.fecha;
        });
    }
  </script>
</body>
</html>
